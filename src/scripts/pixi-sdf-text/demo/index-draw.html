<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SDF text renderer example</title>
    <script src="./assets/OpenSans-Regular.js"></script>
    <script src="../node_modules/pixi.js/dist/pixi.min.js"></script>
    <script src="../dist/pixi-sdf-text.js"></script>
    <style>
        html, body {
            background-color: black;
            color: white;
        }
        a, a:visited {
            color: #39FF14;
        }
        #painting-canvas {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
<canvas id="painting-canvas"></canvas>
<script>
    var app = new PIXI.Application(0, 0, {
        transparent: true
    });

    document.body.appendChild(app.view);

    // load the texture we need
    PIXI.loader.add('font', './assets/OpenSans-Regular.png').load(function (loader, resources) {

        var style = {
            fontSize: 24,
            color: 0x39FF14,
            metrics: window.fontMetrics,
            texture: resources.font.texture
        };

        window.text = new PIXI.sdf.Text('Abc', style);

        //You can cache text as a bitmap to make it cheaper to draw
        //text.cacheAsBitmap = true;

        // Setup the position of the text
        text.x = app.renderer.width / 2;
        text.y = app.renderer.height / 2;

        // Add the text to the scene we are building
        app.stage.addChild(text);

        // Listen for frame updates
        app.ticker.add(function () {
            text.rotation += .01;
            //text.color = Math.random() * 0xffffff;
        });
    });

    var points = [];
    var paintingCanvas = document.getElementById('painting-canvas');
    var ctx = paintingCanvas.getContext('2d');

    paintingCanvas.width = paintingCanvas.offsetWidth;
    paintingCanvas.height = paintingCanvas.offsetHeight;

    function drawLine() {
        ctx.clearRect(0, 0, paintingCanvas.width, paintingCanvas.height);

        if (points.length > 1) {
            ctx.strokeStyle = '#39FF14';
            ctx.beginPath();
            ctx.moveTo(points[0].x, points[0].y);

            for (var i = 1; i < points.length; i++) {
                let x = points[i].x;
                let y = points[i].y;
                ctx.lineTo(x, y);
            }

            ctx.stroke();
        }
    }


    paintingCanvas.addEventListener('click', function(e) {
        points.push({
            x: e.clientX,
            y: e.clientY
        })
        drawLine();
    });
</script>
</body>
</html>
